{% extends "../../views/layout-payment-links-v2.njk" %}

{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "../../views/macros/error-summary.njk" import errorSummary %}

{% block pageTitle %}
  Confirm  - {{ productName }}
{% endblock %}

{% block contentBody %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      {{ errorSummary ({
        errors: errors
      }) }}

      <h1 class="govuk-heading-l" data-cy="product-name">{{ productName }}</h1>

      <h2 class="govuk-heading-m" data-cy="reference-label">{{ __p('paymentLinksV2.confirm.checkYourDetails') }}</h2>

      {% set summaryElementsList = [] %}
      {% for summaryElement in summaryElements %}
        {% set summaryElementsList = (summaryElementsList.push({
            key: {
              text: summaryElement.summaryLabel
            },
            value: {
              text: summaryElement.summaryValue
            },
            actions: {
              items: [
                {
                  href: summaryElement.changeUrl,
                  text: "Change",
                  visuallyHiddenText: summaryElement.summaryLabel
                }
              ]
            }
        }), summaryElementsList) %}
      {% endfor %}

      {{ govukSummaryList({
        attributes: { 'data-cy': 'summary-list'},
        rows: summaryElementsList
      }) }}

      <form method="post" data-cy="form">
        <input id="csrf" name="csrfToken" type="hidden" value="{{ csrf }}"/>

        {% for summaryElement in summaryElements %}
           <input
            id="{{ summaryElement.hiddenFormFieldId }}" 
            name="{{ summaryElement.hiddenFormFieldId }}" 
            type="hidden" value="{{ summaryElement.hiddenFormFieldValue }}" />   
        {% endfor %}

        {% if product.requireCaptcha %}
          <div class="g-recaptcha govuk-!-margin-bottom-5" data-sitekey="{{ GOOGLE_RECAPTCHA_SITE_KEY }}"></div>
        {% endif %}

        {{ govukButton({
          text: 'Continue to payment',
          attributes: { 'data-cy': 'continue-to-payment-button' }
        }) }}
      </form>
    </div>
  </div>
{% endblock %}
